#!/bin/bash

find ~/src/ \( -name dist                               \
            -o -path '*/cabal-dev/lib'                  \
            -o -path '*/cabal-dev/doc' \) -type d       \
            \! -path '*/pushme/dist'                    \
    | xargs /bin/rm -fr

if quickping 192.168.9.135; then
    rsync -avz nu:/home/johnw/.znc/users/johnw/moddata/log/ ~/Messages/znc/
fi

pushme "$@"

volcopy -a --delete ~/Machines/ hermes:Machines/
volcopy -a --delete ~/Products/ hermes:Products/

if [[ $(hostname) == "vulcan.local" ]]; then
    pushme titan
    pushme -Q storage
fi

### pushall ends here
