#!/bin/sh

export PATH=/usr/gnu/bin:/usr/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/local/sbin
export LD_LIBRARY_PATH=/usr/local/lib

imapsync $1 \
    --fast \
    --nofoldersizes \
    --noreleasecheck \
    --syncinternaldates \
    --useheader 'Message-Id' \
    --allowsizemismatch \
    \
    --host1 localhost \
    --port1 993 \
    --ssl1 \
    --user1 johnw \
    --passfile1 /usr/local/etc/archive.secret \
    --authmech1 LOGIN \
    --sep1 '' \
    \
    --host2 imap.gmail.com \
    --port2 993 \
    --ssl2 \
    --user2 jwiegley@gmail.com \
    --passfile2 /usr/local/etc/gmail.secret \
    --authmech2 LOGIN \
    --sep2 '/' \
    \
    --folder 'Archive' --regextrans2 's/Archive/[Gmail]\/All Mail/' \
    --folder 'Lists.Ledger' \
    --folder 'Lists.Bahai.Tarjuman' \
    2>&1
